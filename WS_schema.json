{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "ch.ffhs.webe.canonistic",
  "type": "object",
  "title": "Messages used in Cannonstic",
  "description": "Die im Spiel Cannonsitic genutztent JSON-Meldungen über WebSocket",
  "required": [
    "type",
    "gameid"
  ],
  "properties": {
    "type": {
      "type": "string",
      "enum": [
        "establish",
        "newchat",
        "chat",
        "newturn",
        "turn"
      ],
      "title": "Meldungstyp",
      "default": "chat"
    },
    "gameid": {
      "default": "",
      "description": "Die GameID, diese ist abhängig vom Spieler und dem Spiel",
      "title": "GameID",
      "type": "string"
    },
    "pass": {
      "type": "string",
      "title": "Password",
      "description": "Passworthash in SHA256",
      "default": ""
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "type": {
            "const": "newchat"
          }
        }
      },
      "then": {
        "properties": {
          "newchatmessage": {
            "type": "string",
            "title": "newChat",
            "description": "Neue Nachricht",
            "default": ""
          }
        },
        "required": [
          "newchatmessage"
        ]
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "chat"
          }
        }
      },
      "then": {
        "properties": {
          "msgid": {
            "type": "integer",
            "minimum": 0,
            "title": "ChatId",
            "description": "Nachrichtenid, aufsteigend nummeriert"
          },
          "datetime": {
            "type": "integer",
            "minimum": 0,
            "title": "DateTime",
            "description": "DatumZeit der Nachricht in EPOCH"
          },
          "sender": {
            "type": "string",
            "title": "Absendername"
          },
          "chatmessage": {
            "type": "string",
            "title": "Chatnachricht"
          }
        },
        "required": [
          "msgid",
          "datetime",
          "sender",
          "chatmessage"
        ]
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "newturn"
          }
        }
      },
      "then": {
        "properties": {
          "gunnr": {
            "type": "integer",
            "minimum": 0,
            "title": "Geschütznummer",
            "description": "Nummer des Turmes"
          },
          "v0": {
            "type": "integer",
            "minimum": 1,
            "maximum": 1024,
            "title": "Mündungsgeschwindigkeit",
            "description": "Stärke des Abschusses"
          },
          "elevation": {
            "type": "integer",
            "minimum": -1600,
            "maximum": 1600,
            "title": "Rohrerhebung",
            "description": "0 ist nach Oben, im Uhrzeigersinn"
          },
          "geschoss": {
            "type": "string",
            "enum": [
              "stg"
            ],
            "default": "stg",
            "title": "Geschosstyp"
          }
        },
        "required": [
          "gunnr",
          "v0",
          "elevation"
        ]
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "turn"
          }
        }
      },
      "then": {
        "properties": {
          "gunnr": {
            "type": "integer",
            "minimum": 0,
            "title": "Geschütznummer",
            "description": "Nummer des Turmes"
          },
          "v0": {
            "type": "integer",
            "minimum": 1,
            "maximum": 1024,
            "title": "Mündungsgeschwindigkeit",
            "description": "Stärke des Abschusses"
          },
          "elevation": {
            "type": "integer",
            "minimum": -1600,
            "maximum": 1600,
            "title": "Rohrerhebung",
            "description": "0 ist nach Oben, im Uhrzeigersinn"
          },
          "geschoss": {
            "type": "string",
            "enum": [
              "stg"
            ],
            "default": "stg",
            "title": "Geschosstyp"
          },
          "newwind": {
            "type": "integer",
            "minimum": -1024,
            "maximum": 1024,
            "title": "Wind",
            "description": "negativ ist nach links"
          }
        },
        "required": [
          "gunnr",
          "v0",
          "elevation",
          "gunstates",
          "newwind"
        ]
      }
    }
  ]
}
